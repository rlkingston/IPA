# *------------------------------------------------*
# |                                                |
# | Autogenerated experiment.params example file   |
# |                                                |
# | Comments after // or # will be ignored,        |
# | Only jobs outlined under -JOBS are performed,  |
# | Settings begin with the - (hyphen) character,  |
# | White-spaces separate inputs                   |
# |                                                |
# *------------------------------------------------*

# JOB LIST OPTIONS: INIT ENVELOPE_DETERMINATION ENVELOPE_CONSENSUS PHASE_DETERMINATION PHASE_CONSENSUS
-JOBS INIT ENVELOPE_DETERMINATION ENVELOPE_CONSENSUS PHASE_DETERMINATION PHASE_CONSENSUS # Delete or add desired jobs.

# *-------------- CORE SETTINGS -------------------*
# | These are tagged by the -core keyword          |
# *------------------------------------------------*
# *-----*        COMPULSORY SETTINGS:        *-----*
-core input-data-mtz-filename ./data_and_model/2w4m-sf_plus_calculated_phases.mtz # Path to the mtz file holding the diffraction data.
-core input-data-fsigf-column-labels /*/*/[FP,SIGFP] # The labels for the Structure Factor Amplitudes and their standard deviations in the mtz file
-core input-data-solvent-fraction 0.7697 # The solvent fraction - must be between 0 and 1

# *-----*       RECOMMENDED SETTINGS:        *-----*
-core job-name 2w4m # a customized name for the job 
-core threads 4 # The maximum number of threads/cores to use for the calculations.

# *-----*       OPTIONAL SETTINGS:           *-----*
-core verbose false # Amount of information present in the log-files. Verbose true results in *very* verbose output. 
-core statistics-interval 1 # Controls how frequently the statistics reporting the agreement with the constraints are calculated.
-core infinity-mode false # If true, keep trying to find a solution to the phase problem until the universe suffers heat death.
#-core truncate-data 3.0 # Truncate the high-resolution data on input.
# *-----*   Compositional Settings:    *-----* 
-core protein-sequence ./data_and_model/2w4m_aa_sequence.txt  # Name of a file containing the sequences of any protein chains present in the asymmetric unit,  Use single letter code, white spaces are ignored. There are equivalent keywords for dna or rna.
-core protein-n-chains 1 # the number of distinct chains present in the sequence file. There are equivalent keywords for dna and rna.
-core protein-copies-in-asu 1 # the number of copies of the chains present in the asu. There are equivalent keywords for dna and rna.

# *------------------------------------------------*
# |               ADVANCED SETTINGS                |
# |      Only change these if you                  |
# |      understand what you are doing.            |
# *------------------------------------------------*
# *------- ENVELOPE DETERMINATION SETTINGS --------*
# |    These are tagged by the -envelope keyword   |
# *------------------------------------------------*
-envelope algorithm 1525 1500 DifMap 25 ErrRed 1 pHistogramMatch_sFlatten # A block of iterations, followed by the update rules to be applied and the constraints to be used. These will be repeated in the sequence given until the block ends
-envelope mask-from variance # Controls which local map is used for envelope generation. Accepts mean, variance amd mean-and-variance. In the latter case a number between 0 and 1 gives the weighting.
-envelope mask-redefinition-interval 1 # The number of iterations that elapse before we redefine the protein envelope
-envelope n-density-bins 250 # The # of bins used for remapping of density value histograms
-envelope resolution-bins 40 # The # of bins used for reporting resolution-dependent statistics
-envelope prot-density 0.44 # The expected mean electron density in protein region (electrons/Angstrom^3)
-envelope solvent-density 0.38 # The expected mean electron density in solvent region (electrons/Angstrom^3)
-envelope n-runs 60 # The total number of runs to be executed
-envelope initial-apodization-state 0.09079 # The initial apodization state - specified as the standard deviation of a Gaussian function in Fourier space (1/Å)
-envelope remove-low-res-data 25 # Cutoff for removal of ultra-low resolution data. Data below this limit will be treated as missing throughout
-envelope probability-threshold 0.995 # Probability cutoff used during Fourier space projection. When extimated intensities for the missing data cross this threshold, operations are performed to reduce their magnitude
-envelope replace-largei-with-attenuatedi 0.6 # During Fourier space projection, missing data with improbably large reconstructed intensities will be scaled using the supplied multiplier 
-envelope beta-function 2 # Controls the parametric function via which parameter beta is systematically varied.  1 = square pulse train. 2 = Flattened sinusoid. 
-envelope linear-period-change true # When the function varying beta is chirped, period will be shift linearly with iterate if true, frequency will shift linearly with iterate if false
-envelope resolution-gaussian-width-cutoff 120 # Specifies the fraction of maximum height that will be used to compute the effective resolution of the data, when apodizing with a Gaussian function 
-envelope shannon-rate 1.32 # Controls the gridding of the maps at any effective resolution

# Parameters controlling the value of beta, used in the Difference Map and RRR algorithms
#
#                   Iterate Midline Amplitude Phase  Period  Func2Param  Func1Param
-envelope beta-param      0   0.75    0.120    0.50     56       4            1
-envelope beta-param    699   0.75    0.120    0.50     80       4            1
-envelope beta-param   1399   0.75    0.025    0.50    144       2            1
-envelope beta-param   1499   0.75    0.025    0.50    144       2            1
#
# Parameters controlling the the filter radius, used for generating the molecular envelope
# Specify iterate and radius, the program will linearly interpolate between the specified states
#
#                     Iterate Radius
-envelope filter-param      0 13.25 
-envelope filter-param    699 12.75 
-envelope filter-param   1399 12.25  
-envelope filter-param   1499 12.25 
#
# Parameters controlling the solvent fraction multiplier
# Specify iterate and multiplier, the program will linearly interpolate between the specified states
#
#                      Iterate    Multiplier
-envelope solvent-param 0           1.04
-envelope solvent-param 699         1.02
-envelope solvent-param 1399        1.00
-envelope solvent-param 1499        1.00

# *-------- ENVELOPE CONSENSUS SETTINGS -----------*
# | These are tagged by the -mskconsensus keyword  |
# *------------------------------------------------*
-mskconsensus min-points 4 # DBSCAN parameter MinPoints
-mskconsensus epsilon-as-percentile 8.33 # DBSCAN threshold value ε, specified as a percentile of the k-distance distribution
-mskconsensus erase-islands-threshold 0.05 # defines a threshold for removal of small connected sets during mask connectivity enforcement. Specified as a fraction of the largest set connected set size 
-mskconsensus fill-voids-threshold 0.05 # defines a threshold for removal of small connected sets during mask connectivity enforcement. Specified as a fraction of the largest set connected set size 
-mskconsensus distance-measure 2 # the distance measure used for clustering 1 = 1-|cc|, 2 = √(1-cc^2) 
-mskconsensus allow-inversion # inversion of envelopes will be allowed (if permitted by the space group) when clustering and averaging 
-mskconsensus verbose true # Turn on verbose output for the mask consensus step only

# *-------- PHASE DETERMINATION SETTINGS ----------*
# |    These are tagged by the -phasing keyword    |
# *------------------------------------------------*
#-phasing mskin-target-working /envelope_consensus/jobname/XXXX.ccp4 # Set this to add a specific envelope to the list that will be used during phase determination.
-phasing algorithm 7200 1 DifMap  1 pHistogramMatch_sFlatten # A block of iterations, followed by the update rules to be applied and constraints to be used. These will be repeated in the sequence given until the block ends
-phasing algorithm 900 200 DifMap 25 ErrRed 1 pHistogramMatch_sFlatten # A block of iterations, followed by the update rules to be applied and the constraints to be used. These will be repeated in the sequence given until the block ends
-phasing mask-from variance
-phasing mask-redefinition-interval 1
-phasing n-iterations-fix-mask 10 # the number of iterations for which the mask will be fixed
-phasing n-apodization-steps 31 # the number of apodizations steps 
-phasing n-first-apodization-offset 0 # the number of iterations before we begin adjusting the apodization 
-phasing n-apodization-last-iterate 7440 # the end of the final apodization step
-phasing initial-apodization-state 0.157130378 # The initial apodization state - specified as the standard deviation of a Gaussian function in Fourier space (1/Å)
-phasing remove-low-res-data 25
-phasing n-density-bins 250
-phasing resolution-bins 40
-phasing prot-density 0.44
-phasing solvent-density 0.38
-phasing n-runs 20
-phasing probability-threshold 0.99995 # Probability cutoff used during Fourier space projection. When estimated intensities for the missing data cross this threshold, action is taken to reduce their magnitude
-phasing replace-largei-with-expected-value 1.0 # During Fourier space projection, missing data with improbably large intensities will be replaced with E[|F|]^2, scaled using the supplied multiplier 
-phasing beta-function 1 # Controls the parametric function via which parameter beta is systematically varied.  1 = square pulse train. 2 = Flattened sinusoid. 
-phasing linear-period-change true # When the function varying beta is chirped, period will be shift linearly with iterate if true, frequency will shift linearly with iterate if false
-phasing resolution-gaussian-width-cutoff 120 # Specifies the fraction of maximum height that will be used to compute the effective resolution of the data, when apodizing with a Gaussian function 
-phasing shannon-rate 1.32; # Controls the gridding of the maps at any effective resolution
#-phasing free-lunch 1.0 # Data will be extended past the measured resolution limit, based on the supplied Fourier space volume multiplier (1/Å^3)

# Parameters controlling the value of beta, used in the Difference Map and RRR algorithms
#
#                   Iterate Midline Amplitude Phase  Period  Func2Param  Func1Param
-phasing beta-param  0       0.7375  0.0625    0.250    120   1           0.5
-phasing beta-param  7199    0.7375  0.0625    0.250    120   1           0.5
-phasing beta-param  7200    0.1     0.6500    0.750    200   1           0.5
-phasing beta-param  7399    0.1     0.6500    0.750    200   1           0.5
-phasing beta-param  7400    0.0     0.0000    0.750    200   1           1  
-phasing beta-param  7424    0.0     0.0000    0.750    200   1           1  
-phasing beta-param  7425    0.1     0.6500    0.625    200   1           0.5
-phasing beta-param  7624    0.1     0.6500    0.625    200   1           0.5
-phasing beta-param  7625    0.0     0.0000    0.625    200   1           1  
-phasing beta-param  7649    0.0     0.0000    0.625    200   1           1  
-phasing beta-param  7650    0.1     0.6500    0.500    200   1           0.5
-phasing beta-param  7849    0.1     0.6500    0.500    200   1           0.5
-phasing beta-param  7850    0.0     0.0000    0.500    200   1           1  
-phasing beta-param  7874    0.0     0.0000    0.500    200   1           1  
-phasing beta-param  7875    0.1     0.6500    0.375    200   1           0.5
-phasing beta-param  8074    0.1     0.6500    0.375    200   1           0.5
-phasing beta-param  8075    0.0     0.0000    0.375    200   1           1  
-phasing beta-param  8099    0.0     0.0000    0.375    200   1           1  

# Parameters controlling the the filter radius, used for generating the molecular envelope
# Specify iterate and radius, the program will linearly interpolate between the specified states
#
#                     Iterate Radius
-phasing filter-param  0       8.0
-phasing filter-param  8099    8.0

# Parameters controlling the solvent fraction multiplier
# Specify iterate and multiplier, the program will linearly interpolate between the specified states
#
#                      Iterate    Multiplier
-phasing solvent-param  0          1.0
-phasing solvent-param  8099       1.0
-phasing check-for-consensus-during-phasing true # Whether or not to check for consensus from finished runs in between threads.

# *----------- PHASE CONSENSUS SETTINGS ------------*
# | These are tagged by the -phsconsensus keyword   |
# *------------------------------------------------*
-phsconsensus epsilon 40.0 # DBSCAN threshold value ε, specified in terms of mean absolute phase difference
-phsconsensus min-points 2 # DBSCAN parameter MinPoints
-phsconsensus verbose true # Turn on verbose output for the phase consensus step only


# *-----*        DEBUG and TEST SETTINGS:        *-----*
#-core really-random false # for TESTING and DEBUGGING: If false, generates the same random numbers on each invocation of the program 
-core known-solution-mask-filename ./data_and_model/2w4m-mask.ccp4 # for TESTING and DEBUGGING: A file containing the known mask
-core known-solution-phase-filename ./data_and_model/2w4m-sf_plus_calculated_phases.mtz # for TESTING and DEBUGGING: A file containing known phases 
-core known-solution-fp-column-labels */*/[FP,Calculated_Phase] # for TESTING and DEBUGGING: The labels for the known Fourier amplitudes and phases in the mtz file. Amplitiudes are ignored
-phsconsensus shift-to-known-origin # for TESTING and DEBUGGING: consensus phase sets will be shifted to the same origin as a known phase set, and written out 
-mskconsensus shift-to-known-origin # for TESTING and DEBUGGING: consensus envelopes will be shifted to the same origin as a known envelope, and written out

